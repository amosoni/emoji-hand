# ğŸ“Š **åŸºäºæˆæœ¬çš„è®¢é˜…ç³»ç»Ÿå®ç°**

## ğŸ¯ **ç³»ç»Ÿæ¦‚è¿°**

åŸºäºå®é™…AIæˆæœ¬åˆ†æï¼Œå®ç°äº†ç®€å•æœ‰æ•ˆçš„è®¢é˜…ç³»ç»Ÿï¼Œæ”¯æŒç¿»è¯‘å’Œå›¾åƒç”ŸæˆåŠŸèƒ½ã€‚

## ğŸ’° **æˆæœ¬åˆ†æ**

### **AIæ¨¡å‹æˆæœ¬**
| åŠŸèƒ½ | AIæ¨¡å‹ | å•æ¬¡æˆæœ¬ | è¯´æ˜ |
|------|--------|----------|------|
| ç¿»è¯‘ | GPT-3.5-turbo | $0.001 | å…è´¹ç”¨æˆ· |
| ç¿»è¯‘ | GPT-4 | $0.01 | ä»˜è´¹ç”¨æˆ· |
| å›¾åƒç”Ÿæˆ | DALL-E 3 | $0.04 | æ‰€æœ‰ç”¨æˆ· |

### **è®¢é˜…è®¡åˆ’è®¾è®¡**
| è®¡åˆ’ | ä»·æ ¼ | ç¿»è¯‘æ¬¡æ•° | å›¾åƒç”Ÿæˆ | æœˆæˆæœ¬ | åˆ©æ¶¦ç‡ |
|------|------|----------|----------|--------|--------|
| å…è´¹ | $0 | 8æ¬¡/æ—¥ | 0æ¬¡/æ—¥ | $0.24 | - |
| Starter | $9.99 | 15æ¬¡/æ—¥ | 2æ¬¡/æ—¥ | $6.9 | 31% |
| Pro | $19.99 | 35æ¬¡/æ—¥ | 5æ¬¡/æ—¥ | $16.5 | 17% |
| Enterprise | $39.99 | 70æ¬¡/æ—¥ | 10æ¬¡/æ—¥ | $33 | 17% |

## ğŸ—„ï¸ **æ•°æ®åº“è®¾è®¡**

### **Useræ¨¡å‹æ›´æ–°**
```prisma
model User {
  // è®¢é˜…ç³»ç»Ÿ
  subscriptionPlan    String   @default("free")
  subscriptionExpireAt DateTime?
  subscriptionStatus   String   @default("active")
  
  // ä½¿ç”¨ç»Ÿè®¡
  translationUsesToday      Int @default(0)
  imageGenerationUsesToday Int @default(0)
  lastUsageReset           DateTime @default(now())
  
  // ç§¯åˆ†ç³»ç»Ÿ (ä¿ç•™å…¼å®¹æ€§)
  credits            Int      @default(0)
  totalCreditsEarned Int      @default(0)
  totalCreditsSpent  Int      @default(0)
}
```

## ğŸ”§ **åç«¯å®ç°**

### **1. è®¢é˜…è·¯ç”± (`emoji-pack-subscription.ts`)**
- `getSubscriptionPlans`: è·å–è®¢é˜…è®¡åˆ’é…ç½®
- `getSubscription`: è·å–ç”¨æˆ·è®¢é˜…çŠ¶æ€
- `checkUsageLimit`: æ£€æŸ¥ä½¿ç”¨é™åˆ¶
- `recordUsage`: è®°å½•ä½¿ç”¨é‡
- `upgradeSubscription`: å‡çº§è®¢é˜…

### **2. ä½¿ç”¨é™åˆ¶è·¯ç”± (`usage-limits.ts`)**
- `checkServiceLimit`: æ£€æŸ¥æœåŠ¡ä½¿ç”¨é™åˆ¶
- `recordServiceUsage`: è®°å½•æœåŠ¡ä½¿ç”¨
- `getUserUsageStats`: è·å–ç”¨æˆ·ä½¿ç”¨ç»Ÿè®¡

### **3. ç§¯åˆ†è·¯ç”± (`emoji-pack-credits.ts`)**
- `getEmojiPackCredits`: è·å–ç§¯åˆ†ä¿¡æ¯
- `getCreditPackages`: è·å–ç§¯åˆ†å¥—é¤
- `purchaseEmojiPackCredits`: è´­ä¹°ç§¯åˆ†
- `consumeEmojiPackCredits`: æ¶ˆè´¹ç§¯åˆ†

## ğŸ¨ **å‰ç«¯å®ç°**

### **ä½¿ç”¨é™åˆ¶æ˜¾ç¤ºç»„ä»¶ (`UsageLimitDisplay.tsx`)**
- å®æ—¶æ˜¾ç¤ºä½¿ç”¨é‡
- è¿›åº¦æ¡å¯è§†åŒ–
- è®¢é˜…çŠ¶æ€æ˜¾ç¤º
- å‡çº§æŒ‰é’®

## ğŸ“‹ **åŠŸèƒ½ç‰¹æ€§**

### **1. ç»Ÿä¸€çš„ä½¿ç”¨é™åˆ¶**
- ç¿»è¯‘åŠŸèƒ½ï¼šç»Ÿä¸€è®¡ç®—æ‰€æœ‰é£æ ¼
- å›¾åƒç”Ÿæˆï¼šç»Ÿä¸€è®¡ç®—Emojiå’ŒLovartè®¾è®¡
- æ¯æ—¥è‡ªåŠ¨é‡ç½®

### **2. è®¢é˜…ä¼˜å…ˆçº§**
- æœ‰è®¢é˜…ï¼šä½¿ç”¨è®¢é˜…é™åˆ¶
- æ— è®¢é˜…ï¼šä½¿ç”¨ç§¯åˆ†ç³»ç»Ÿ
- è‡ªåŠ¨åˆ‡æ¢é€»è¾‘

### **3. æˆæœ¬æ§åˆ¶**
- åŸºäºå®é™…AIæˆæœ¬å®šä»·
- åˆç†çš„åˆ©æ¶¦ç‡ä¿éšœ
- åŠ¨æ€ä½¿ç”¨é‡è°ƒæ•´

## ğŸ”„ **ç”¨æˆ·æµç¨‹**

### **1. å…è´¹ç”¨æˆ·**
```
è®¿é—® â†’ ä½“éªŒç¿»è¯‘ â†’ 8æ¬¡ç”¨å®Œ â†’ æç¤ºå‡çº§
```

### **2. ä»˜è´¹ç”¨æˆ·**
```
è®¢é˜… â†’ ä½¿ç”¨åŠŸèƒ½ â†’ æ¯æ—¥é™åˆ¶ â†’ æ¬¡æ—¥é‡ç½®
```

### **3. ç§¯åˆ†ç”¨æˆ·**
```
è´­ä¹°ç§¯åˆ† â†’ æ¶ˆè´¹ç§¯åˆ† â†’ ä½™é¢ä¸è¶³ â†’ å†æ¬¡è´­ä¹°
```

## ğŸš€ **éƒ¨ç½²çŠ¶æ€**

### **âœ… å·²å®Œæˆ**
- [x] æ•°æ®åº“æ¨¡å‹æ›´æ–°
- [x] åç«¯APIè·¯ç”±
- [x] ä½¿ç”¨é™åˆ¶é€»è¾‘
- [x] ç§¯åˆ†ç³»ç»Ÿé›†æˆ
- [x] å‰ç«¯æ˜¾ç¤ºç»„ä»¶
- [x] ç¿»è¯‘æ–‡ä»¶æ›´æ–°

### **ğŸ”„ è¿›è¡Œä¸­**
- [ ] å‰ç«¯é¡µé¢é›†æˆ
- [ ] æ”¯ä»˜ç³»ç»Ÿé›†æˆ
- [ ] ç”¨æˆ·ç•Œé¢ä¼˜åŒ–

### **ğŸ“‹ å¾…å®Œæˆ**
- [ ] é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ
- [ ] ä½¿ç”¨ç»Ÿè®¡ä»ªè¡¨æ¿
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•
- [ ] æ€§èƒ½ç›‘æ§

## ğŸ’¡ **ä½¿ç”¨ç¤ºä¾‹**

### **æ£€æŸ¥ä½¿ç”¨é™åˆ¶**
```typescript
const limitCheck = await api.usageLimits.checkServiceLimit.query({
  service: 'translation'
});

if (limitCheck.canUse) {
  // æ‰§è¡Œç¿»è¯‘
  await api.usageLimits.recordServiceUsage.mutate({
    service: 'translation'
  });
} else {
  // æ˜¾ç¤ºé™åˆ¶ä¿¡æ¯
  showLimitMessage(limitCheck.message);
}
```

### **è·å–ä½¿ç”¨ç»Ÿè®¡**
```typescript
const stats = await api.usageLimits.getUserUsageStats.query();

console.log(`ç¿»è¯‘: ${stats.usage.translation.used}/${stats.usage.translation.limit}`);
console.log(`å›¾åƒ: ${stats.usage.imageGeneration.used}/${stats.usage.imageGeneration.limit}`);
```

## ğŸ¯ **ä¼˜åŠ¿æ€»ç»“**

1. **ç®€å•æ˜äº†** - ç”¨æˆ·å®¹æ˜“ç†è§£
2. **æˆæœ¬é€æ˜** - åŸºäºå®é™…AIæˆæœ¬
3. **åˆ©æ¶¦ä¿éšœ** - åˆç†çš„åˆ©æ¶¦ç‡
4. **çµæ´»æ‰©å±•** - æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
5. **ç”¨æˆ·å‹å¥½** - æ¸…æ™°çš„ä½¿ç”¨é™åˆ¶

è¿™ä¸ªç³»ç»Ÿä¸ºä½ çš„å¤šç”Ÿæˆå™¨é¡¹ç›®æä¾›äº†å®Œæ•´çš„ä½¿ç”¨é™åˆ¶å’Œè®¢é˜…ç®¡ç†è§£å†³æ–¹æ¡ˆï¼ 